pipeline {
    agent any
    stages {
        stage('Setup') {
            steps {
                sh 'cd cpp/lib && git clone https://github.com/google/googletest.git'
                sh 'cd cpp/lib && git clone https://github.com/unittest-cpp/unittest-cpp.git'
            }
        }
        stage('cmake && build') {
            steps {
                sh 'cd cpp && cmake -S . -B build && cmake --build build --target all'
            }
        }
        stage('run Boost.Test') {
            steps {
                sh './cpp/build/frameworks/boost.test/Boost.Test'
            }
        }
        stage('run Catch2') {
            steps {
                sh './cpp/build/frameworks/catch2/Catch2Test'
            }
        }
        stage('run googletest') {
            steps {
                sh './cpp/build/frameworks/googletest/GoogleTest'
            }
        }
        stage('run unittest++') {
            steps {
                sh './cpp/build/frameworks/unittest++/UnitTestPP'
            }
        }
    }
}